<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harmonic Progression</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js"></script>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div id="app">
        <div class="container">
            <!-- User's Answer -->
            <div class="answer-row">
                <div class="answer-section" :class="resultClass">
                    <p>{{ userProgressionDisplay }}</p>
                </div>
                <button @click="undoChord" class="btn btn-small answer-undo">â†¶</button>
            </div>

            <!-- Chord Buttons grouped by scale degree -->
            <div class="chord-grid">
                <div 
                    class="degree-group"
                    v-for="group in chordGroups" 
                    :key="group.degree"
                >
                    <button
                        v-for="chord in group.chords"
                        :key="chord"
                        @click="guessChord(chord)"
                        class="btn btn-chord"
                    >
                        {{ chord }}
                    </button>
                </div>
            </div>

            <!-- Play Buttons (moved below chord buttons) -->
            <div class="button-group">
                <button @click="playProgression" class="btn btn-primary">â–¶ Play Progression</button>
                <button @click="repeatProgression" class="btn btn-primary">â†» Repeat</button>
            </div>

            <!-- Result Message (solution) -->
            <div v-if="resultMessage" class="result">
                {{ resultMessage }}
            </div>

            <!-- Chord Notes Display (stacked solution) -->
            <div v-if="chordNotesDisplay" class="chord-notes">
                {{ chordNotesDisplay }}
            </div>

            <!-- Score moved below resolution/solution box -->
            <div class="score-section">
                <p class="score">Score: {{ score }}/{{ total }}</p>
            </div>

            <!-- Bottom controls: settings and additional playback buttons -->
            <div class="bottom-controls">
                <!-- Options Section moved to bottom -->
                <div class="options-section">
                    <div class="control-group">
                        <label>Instrument:</label>
                        <select v-model="selectedInstrument">
                            <option>Piano</option>
                            <option>Bell</option>
                            <option>Violin</option>
                            <option>Flute</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label>Number of Chords:</label>
                        <select v-model="numChords">
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                            <option>Random</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label>Root Note Volume: {{ rootVolume }}%</label>
                        <input type="range" v-model.number="rootVolume" min="100" max="1000" step="10">
                    </div>

                    <div class="control-group">
                        <label>Playback Speed: {{ (playbackSpeed).toFixed(1) }}x</label>
                        <input type="range" v-model.number="playbackSpeed" min="0.5" max="4.0" step="0.1">
                    </div>

                    <div class="checkboxes">
                        <label>
                            <input type="checkbox" v-model="startOnTonic">
                            Start on Tonic
                        </label>
                        <label>
                            <input type="checkbox" v-model="useCommonOnly">
                            Common Progressions Only
                        </label>
                    </div>
                </div>

                <div class="button-group bottom-button-group">
                    <button @click="playArpeggio" class="btn btn-primary">â–¶ Play as Arpeggio</button>
                    <button @click="playTonic" class="btn btn-secondary">â™ª Play Tonic</button>
                    <button @click="testAudio" class="btn btn-secondary">ðŸ”Š Test Audio</button>
                </div>
            </div>

            <!-- Exit Button -->
            <button @click="exit" class="btn btn-danger">Exit</button>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
